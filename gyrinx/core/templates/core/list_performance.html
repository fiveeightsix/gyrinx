{% extends "core/layouts/foundation.html" %}
{% load allauth custom_tags %}
{% block head_title %}
    {{ list.name }} | {{ list.owner_cached }}
{% endblock head_title %}
{% block base %}
    <h2>List Details</h2>
    <ul>
        <li>{{ list.name }}</li>
        <li>Archived? {{ list.archived|yesno:"Yes,No" }}</li>
        <li>{{ list.owner_cached }}</li>
        <li>{{ list.owner_cached.username }}</li>
        <li>{{ list.content_house_name }}</li>
        <li>{{ list.is_campaign_mode }}</li>
        <li>
            {% if list.public %}
                Public
            {% else %}
                Private
            {% endif %}
        </li>
        <li>
            {% if list.owner_cached == user %}Owner{% endif %}
        </li>
        <li>{{ list.original_list }}</li>
        <li>{{ list.campaign }}</li>
        <li>Clones? {{ list.active_campaign_clones|length|yesno:"Yes,No" }}</li>
    </ul>
    <h2>List Attributes</h2>
    <ul>
        {% for attribute_assign in list.active_attributes_cached %}
            <li>{{ attribute_assign.attribute_value.name }}: {{ attribute_assign.attribute_value.attribute }}</li>
        {% empty %}
            <li>No attributes assigned.</li>
        {% endfor %}
    </ul>
    <h2>Available Attributes</h2>
    {% if list.all_attributes %}
        <table class="table table-sm mb-0 fs-7">
            <tbody>
                {% for attribute in list.all_attributes %}
                    <tr>
                        <td>{{ attribute.name }}</td>
                        <td>
                            {% if attribute.assignments %}
                                {{ attribute.assignments|join:", " }}
                            {% else %}
                                <span class="text-muted">Not set</span>
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p class="text-muted fs-7 mb-0">No attributes available.</p>
    {% endif %}
    <h2>List Fighters</h2>
    <table class="table table-sm mb-0 fs-7">
        <tbody>
            <tr>
                <th>Name</th>
                <th>Injury State</th>
                <th>Captured / Sold to Guilders</th>
                <th>Linked Fighter</th>
            </tr>
            {% for fighter in list.active_fighters %}
                <tr>
                    <td>{{ fighter.name }}</td>
                    <td>{{ fighter.get_injury_state_display }}</td>
                    <td>
                        {{ fighter.is_captured |yesno:"Captured,Not Captured" }} / {{ fighter.is_sold_to_guilders |yesno:"Sold to Guilders,Not Sold" }}
                    </td>
                    <td>
                        {% if fighter.has_linked_fighter %}
                            {{ fighter.term_proximal_demonstrative }} is linked
                            to {{ fighter.linked_list_fighter.name }}
                        </td>
                    {% else %}
                        <span class="text-muted">No linked fighter</span>
                    {% endif %}
                </tr>
            {% empty %}
                <tr>
                    <td>No fighters in this list.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock base %}
