{% extends "core/layouts/base.html" %}
{% load allauth custom_tags %}
{% block head_title %}
    Print Configurations - {{ list.name }}
{% endblock head_title %}
{% block content %}
    {% include "core/includes/back_to_list.html" %}
    <div class="col-12 col-md-8 col-lg-6 px-0 vstack gap-3">
        <div class="d-flex justify-content-between align-items-center">
            <h1 class="h3">Print Configurations</h1>
            <a href="{% url 'core:print-config-create' list.id %}"
               class="btn btn-primary btn-sm">
                {% element icon "plus" %}
                    New Configuration
                </a>
            </div>
            <p class="text-muted">
                Manage print configurations for <strong>{{ list.name }}</strong>.
                Create custom configurations to control which cards and fighters are included when printing.
            </p>
            {% if print_configs %}
                <div class="table-responsive">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Cards</th>
                                <th class="text-end">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Default configuration (always present) -->
                            <tr>
                                <td>
                                    <strong>Default</strong>
                                    <span class="badge bg-secondary ms-2">Built-in</span>
                                </td>
                                <td class="text-muted">All cards and active fighters</td>
                                <td class="text-end">
                                    <a href="{% url 'core:list-print' list.id %}"
                                       class="btn btn-outline-secondary btn-sm">
                                        {% element icon "eye" %}
                                            Print
                                        </a>
                                    </td>
                                </tr>
                                <!-- User configurations -->
                                {% for config in print_configs %}
                                    <tr>
                                        <td>
                                            <strong>{{ config.name }}</strong>
                                            {% if config.is_default %}<span class="badge bg-primary ms-2">Default</span>{% endif %}
                                        </td>
                                        <td class="text-muted">{{ config.card_summary }}</td>
                                        <td class="text-end">
                                            <div class="btn-group" role="group">
                                                <a href="{% url 'core:print-config-print' list.id config.id %}"
                                                   class="btn btn-outline-secondary btn-sm">
                                                    {% element icon "eye" %}
                                                        Print
                                                    </a>
                                                    <a href="{% url 'core:print-config-edit' list.id config.id %}"
                                                       class="btn btn-secondary btn-sm">
                                                        {% element icon "pencil" %}
                                                            Edit
                                                        </a>
                                                        <form action="{% url 'core:print-config-delete' list.id config.id %}"
                                                              method="post"
                                                              class="d-inline"
                                                              onsubmit="return confirm('Are you sure you want to delete this print configuration?');">
                                                            {% csrf_token %}
                                                            <button type="submit" class="btn btn-danger btn-sm">
                                                                {% element icon "trash" %}
                                                                    Delete
                                                                </button>
                                                            </form>
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            {% else %}
                                <div class="border rounded p-4 text-center">
                                    <p class="text-muted mb-3">You haven't created any custom print configurations yet.</p>
                                    <a href="{% url 'core:print-config-create' list.id %}"
                                       class="btn btn-primary btn-sm">
                                        {% element icon "plus" %}
                                            Create Your First Configuration
                                        </a>
                                    </div>
                                {% endif %}
                            </div>
                        {% endblock content %}
